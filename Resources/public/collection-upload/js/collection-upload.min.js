$.widget("blueimp.fileupload",$.blueimp.fileupload,{_initButtonBarEventHandlers:function(){var b=this;var a=this.element.find(".fileupload-buttonbar"),c=this.options.filesContainer;this._on(a.find(".cancel"),{click:function(d){d.preventDefault();c.find(".cancel button").click();}});this._on(a.find(".delete"),{click:function(d){d.preventDefault();if(confirm(b.options.messages.confirmBatchDelete)){c.find(".delete input:checked").parent().siblings("button").click();a.find(".toggle").prop("checked",false);}}});this._on(a.find(".toggle"),{change:function(d){c.find(".delete input").prop("checked",$(d.currentTarget).is(":checked"));}});}});(function(e,c,g){var d="uploadCollection",a=c.document,f={sortable:false,sortable_field:"position",messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too big",minFileSize:"File is too small",confirmBatchDelete:"Are you sure you want to delete all selected elements?"},javascript:function(h){}};function b(i,h){this.element=i;this.options=e.extend({},f,h);this._defaults=f;this._name=d;this._init();}b.prototype={_init:function(){var h=this;this.$element=e(this.element);this.$widgetContainer=e("#"+this.element.id+"_widget_container");this.$filesContainer=e("#"+this.element.id+"_files_list");this.$widgetContainer.fileupload({messages:this.options.messages,fileInput:this.$element,replaceFileInput:false,uploadTemplateId:this.element.id+"_upload_template",downloadTemplateId:this.element.id+"_download_template",filesContainer:this.$filesContainer,dropZone:this.$widgetContainer,pasteZone:this.$widgetContainer,maxNumberOfFiles:this.options.maxNumberOfFiles,maxFileSize:this.options.maxFileSize,minFileSize:this.options.minFileSize,acceptFileTypes:this.options.acceptFileTypes,previewAsCanvas:this.options.previewAsCanvas,prependFiles:this.options.prependFiles,previewSourceFileTypes:this.options.previewSourceFileTypes,previewSourceMaxFileSize:this.options.previewSourceMaxFileSize,previewMaxWidth:this.options.previewMaxWidth,previewMaxHeight:this.options.previewMaxHeight});if(this.options.sortable){e("#"+this.element.id+"_files_list").sortable({helper:function(j,i){i.children().each(function(){e(this).css("width",e(this).width());});return i;},handle:".handle",cursor:"move",items:"> tr.template-download",axis:"y",forceHelperSize:true,forcePlaceholderSize:true,placeholder:"sortable-placeholder",over:function(k,j){var l=h.$filesContainer.find("tr.ui-sortable-helper");var i=h.$filesContainer.find("tr.sortable-placeholder");i.css("height",l.height());},update:function(j,i){i.item.children().each(function(){e(this).css("width","");});e('[id^="'+h.element.id+'"][id$="'+h.options.sortable_field+'"]').each(function(k){e(this).val(k);});},start:function(i,j){h.ckeConfigs=[];e("textarea",j.item).each(function(){var l=e(this).attr("id");if(CKEDITOR.instances[l]){var k=e(this).next(".cke").clone().addClass("cloned");h.ckeConfigs[l]=CKEDITOR.instances[l].config;CKEDITOR.instances[l].destroy();e(this).hide().after(k);}});},stop:function(i,j){e("textarea",j.item).each(function(){var k=e(this).attr("id");if(h.ckeConfigs[k]){CKEDITOR.replace(k,h.ckeConfigs[k]);e(this).next(".cloned").remove();}});}});}},loadFiles:function(h){this.$widgetContainer.fileupload("option","done").call(this.$widgetContainer,null,{result:h});}};e.fn[d]=function(i){var h=arguments;if(i===g||typeof i==="object"){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,i));}});}else{if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var j;this.each(function(){var k=e.data(this,"plugin_"+d);if(k instanceof b&&typeof k[i]==="function"){j=k[i].apply(k,Array.prototype.slice.call(h,1));}if(i==="destroy"){e.data(this,"plugin_"+d,null);}});return j!==g?j:this;}}};}(jQuery,window));